<!DOCTYPE html>
<html lang="eng-us">

<!--  test.html to test the API for showtimes


-->


<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Pong 2180 User Interface</title>
    <!-- <link rel="stylesheet" type="text/css" href="style_test.css">  -->

    <!--<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">  -->

    <!-- load in a reset of CSS  -->
    <!-- *RPB  redo the styles after loading in the rest.css  -->
    <!-- <link rel="stylesheet" type="text/css" href="assets/css/reset.css">   -->
    <!-- load my style sheet -->
    <!-- JQuery -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <!--
  <script src="https://code.jquery.com/jquery-2.2.4.min.js"></script>
  -->


    <!-- Bootstrap CDN-->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="assets/css/maps.css">
    <link rel="stylesheet" type="text/css" src="assets/css/map-icons.css">
    <link rel="stylesheet" href="assets/css/theater.css">
    <link rel="stylesheet" href="assets/css/style_test.css">

    <!--
    <script type="text/javascript" src="assets/javascript/map-icons.js"></script>
-->
    <script src="https://www.gstatic.com/firebasejs/4.12.1/firebase.js"></script>

    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="assets/javascript/moment.js"></script>
    <script src="assets/javascript/numeral.js"></script>

    <!-- hover for picking movies -->
    <style>
        div.rowPick:hover {
            background-color: lightgreen;
        }
    </style>
    <!-- hover for picking theater after movie is selected -->
    <style>
        div.rowPick2:hover {
            background-color: lightseagreen;
        }
    </style>
</head>

<body>
    <div class="wrapper" id="page1">
        <div class="container-fluid">
            <div class="panel panel-info" style="padding:3px; margin: 3px;">
                <div class="panel-body" style="padding:3px; margin: 3px;">
                    <div style="float: left;">
                        <h3 style="padding:3px; margin: 3px;">Pong 2180 User Demo</h3>
                    </div>
                    <button type="button" class="btn btn-default btn-lg btn-info" style="margin: 0px 0px 0px 50px;">
                        <span class="glyphicon glyphicon-info-sign" aria-hidden="true"></span>
                    </button>
                    <div class="wrapper">
                        <div class="row">
                            <div id="inputSect" style="margin:3px; padding:3px">
                                <label for="number-input">Address you are at</label>
                                <input type="text" id="input-addr" style="display:inline;" maxlength="40" size="40">
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-2">
                                <label>Ball : </label>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-2">
                                <label>X pos</label>
                            </div>
                            <div class="col-md-2">
                                <label id="ball-pos-x">- - - - </label>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-2">
                                <label>Y pos</label>
                            </div>
                            <div class="col-md-2">
                                <label id="ball-pos-y">- - - - </label>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-2">
                                <label>Lat </label>
                            </div>
                            <div class="col-md-2">
                                <label id="ball-pos-lat">- - - - </label>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-2">
                                <label>Lon </label>
                            </div>
                            <div class="col-md-2">
                                <label id="ball-pos-lon">- - - - </label>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-2">
                                <label>Speed</label>
                            </div>
                            <div class="col-md-2">
                                <label id="ball-vel-in">- - - - </label>
                            </div>
                            <div class="col-md-2">
                                <label id="ball-vel-mph">- - - - </label>
                            </div>
                        </div>

                        <div class="row">
                                <div class="col-md-2">
                                    <label> </label>
                                </div>
                                <div class="col-md-2">
                                    <label id=""> </label>
                                </div>
                            </div>    
                        <div class="row">
                            <div class="col-md-2">
                                <label>Distances:</label>
                            </div>
                            <div class="col-md-2">
                                <label id=""> </label>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-2">
                                <label>to player #1</label>
                            </div>
                            <div class="col-md-2">
                                <label id="ball-dist-play1">- - - - </label>
                            </div>
                            <div class="col-md-2">
                                <label id="ball-miles-play1">- - - - </label>
                            </div>
                            <div class="col-md-4">
                                <label id="loc-play-1">- - - - </label>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-2">
                                <label> </label>
                            </div>
                            <div class="col-md-2">
                                <label id="ball-time-play1-sec">- - - - </label>
                            </div>
                            <div class="col-md-2">
                                <label id="ball-time-play1-min">- - - - </label>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-2">
                                <label>to player #2</label>
                            </div>
                            <div class="col-md-2">
                                <label id="ball-dist-play2">- - - - </label>
                            </div>
                            <div class="col-md-2">
                                <label id="ball-miles-play2">- - - - </label>
                            </div>
                            <div class="col-md-4">
                                <label id="loc-play-2">- - - - </label>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-2">
                                <label> </label>
                            </div>
                            <div class="col-md-2">
                                <label id="ball-time-play2-sec">- - - - </label>
                            </div>
                            <div class="col-md-2">
                                <label id="ball-time-play2-min">- - - - </label>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-2">
                                <label>between players </label>
                            </div>
                            <div class="col-md-2">
                                <label id="ball-dist-total">- - - - </label>
                            </div>
                            <div class="col-md-2">
                                <label id="ball-dist-miles">- - - - </label>
                            </div>
                        </div>

                    </div>
                </div>
                <!---
                            <button id="bttnUserInput">Start Search</button>
                -->

            </div>
        </div>

        <!-- 
    <div id="page2">
        <div class="page2-only">
            <ul class="nav nav-tabs">
                <li role="presentation" class="active">
                    <a href="#">Output format</a>
                </li>
                <li role="presentation">
                    <a href="#movieOutput">Show Movies</a>
                </li>
                <li role="presentation">
                    <a href="#bottom-panel-div">Show Theaters</a>
                </li>
            </ul>
        </div>
        <div class="wrapper">
            <div class="container-fluid">
                <div class="panel panel-info" style="max-height:300px; overflow: auto; overflow-y: auto;">
                    <div class="panel-body" style="height:100%">
                        <div id="movieOutput" style="margin:5px; padding:5px"></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="wrapper page2-only">
            <div class="container-fluid">
                <div class="panel panel-info" style="max-height:200px; overflow: auto; overflow-y: auto;">
                    <div class="panel-body" style="height:100%">
                        <div id="bottom-panel-div" style="margin:5px; padding:5px"></div>
                    </div>
                </div>
            </div>
        </div>
    </div> -->

        <!-- Modal windows come up next -->
        <!-- Info Modal -->
        <div id="modInfo" class="modal" style="height: 400px; width:90%;">
            <div class="modal-content" style="height:90%; width:90%;">
                <span id="closeModInfo" class="close close-Info">&times;</span>
                <h2>
                    <p>Information:</p>
                </h2>
                <p>Demonstration of Pong 2180</p>
                <p>Demo to show: 1. GPS entry 2. Address Generation</p>
                <p>3. Firebase disp coord 4. Google Maps Display</p>
                <p></p>
            </div>
        </div>
        <!-- GPS Modal -->
        <div id="modLocation" class="modal">
            <div class="modal-content">
                <span id="closeModLocation" class="close">&times;</span>
                <h2>
                    <p>Searching for GPS location</p>
                </h2>
                <p> </p>
                <p>Please allow location privaledge and then wait</p>
            </div>
        </div>
        <!-- Searching for all movie entries Modal -->
        <div id="modSearch1" class="modal">
            <div class="modal-content">
                <span id="closeModSearch1" class="close">&times;</span>
                <h2>
                    <p>Searching for all theaters and movies within search area</p>
                </h2>
                <p> </p>
                <p>Please wait ...</p>
            </div>
        </div>
        <!-- Searching for all movie entries Modal -->
        <div id="modSearch2" class="modal">
            <div class="modal-content">
                <span id="closeModSearch2" class="close">&times;</span>
                <h2>
                    <p>Searching for all movie data </p>
                </h2>
                <p> </p>
                <p>Please wait ...</p>
            </div>
        </div>
        <!-- Searching for cinema address Modal -->
        <div id="modSearch3" class="modal">
            <div class="modal-content">
                <span id="closeModSearch3" class="close">&times;</span>
                <h2>
                    <p>Searching for addresses </p>
                </h2>
                <p> </p>
                <p>Please wait ...</p>
            </div>
        </div>

        <!-- Searching for cinema address Modal -->
        <div id="modMovieTimes" class="modal">
            <div class="modal-content">
                <span id="closeModMovieTimes" class="close">&times;</span>
                <h2>
                    <p>Getting movie times</p>
                </h2>
                <p> </p>
                <p>Please wait ...</p>
            </div>
        </div>
        <!-- test elements for maps -->


        <!--
    <div class="container-fluid" id="container-map">
        <div class="row" style="height:700px; width:400px">
            <div id="map"></div>
        </div>
    </div>
-->

        <!-- style="height:90%; width:1020px; padding:2px" -->
        <!-- style="height:70%; width:1000px; margin:0px; padding: 2px" -->
        <div id="modMap" class="modal" style="height:640px; width:420px; padding:2px">
            <div class="modal-content" style="height:90%; width:90%; margin:0px; padding: 2px">
                <span>
                    <h2>Map</h2>
                </span>
                <span id="closeModMap" class="close">&times;</span>
                <div id="map" style="height:85%; width:100%"></div>
            </div>
        </div>


        <script src="assets/javascript/globals.js"></script>
        <script src="assets/javascript/moviesearch.js"></script>
        <script src="assets/javascript/restlocat.js"></script>
        <script src="assets/javascript/connComm.js"></script>
        <!-- load my custom js for this project -->
        <!--   
        <script src="assets/javascript/script.js"></script>
        -->

        <!--Script tag to load Google Maps Javascript Library -->
        <!--
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAE03QBe5yDXRr1fzDvkWs9i_E_BIyCDhk&libraries=places&callback=initMap"
        async defer></script>  -->
        <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAE03QBe5yDXRr1fzDvkWs9i_E_BIyCDhk&libraries=places" async
            defer></script>
        <!--
    <script src="https://maps.googleapis.com/maps/api/staticmap?key=AIzaSyAE03QBe5yDXRr1fzDvkWs9i_E_BIyCDhk&center=-33.9,151.14999999999998&zoom=12&format=png&maptype=roadmap&style=element:geometry%7Ccolor:0x1d2c4d&style=element:labels.text.fill%7Ccolor:0x8ec3b9&style=element:labels.text.stroke%7Ccolor:0x1a3646&style=feature:administrative.country%7Celement:geometry.stroke%7Ccolor:0x4b6878&style=feature:administrative.land_parcel%7Celement:labels.text.fill%7Ccolor:0x64779e&style=feature:administrative.province%7Celement:geometry.stroke%7Ccolor:0x4b6878&style=feature:landscape.man_made%7Celement:geometry.stroke%7Ccolor:0x334e87&style=feature:landscape.natural%7Celement:geometry%7Ccolor:0x023e58&style=feature:poi%7Celement:geometry%7Ccolor:0x283d6a&style=feature:poi%7Celement:labels.text.fill%7Ccolor:0x6f9ba5&style=feature:poi%7Celement:labels.text.stroke%7Ccolor:0x1d2c4d&style=feature:poi.park%7Celement:geometry.fill%7Ccolor:0x023e58&style=feature:poi.park%7Celement:labels.text.fill%7Ccolor:0x3C7680&style=feature:road%7Celement:geometry%7Ccolor:0x304a7d&style=feature:road%7Celement:labels.text.fill%7Ccolor:0x98a5be&style=feature:road%7Celement:labels.text.stroke%7Ccolor:0x1d2c4d&style=feature:road.highway%7Celement:geometry%7Ccolor:0x2c6675&style=feature:road.highway%7Celement:geometry.stroke%7Ccolor:0x255763&style=feature:road.highway%7Celement:labels.text.fill%7Ccolor:0xb0d5ce&style=feature:road.highway%7Celement:labels.text.stroke%7Ccolor:0x023e58&style=feature:transit%7Celement:labels.text.fill%7Ccolor:0x98a5be&style=feature:transit%7Celement:labels.text.stroke%7Ccolor:0x1d2c4d&style=feature:transit.line%7Celement:geometry.fill%7Ccolor:0x283d6a&style=feature:transit.station%7Celement:geometry%7Ccolor:0x3a4762&style=feature:water%7Celement:geometry%7Ccolor:0x0e1626&style=feature:water%7Celement:labels.text.fill%7Ccolor:0x4e6d70&size=480x360"></script>
        -->
        <script src="https://apis.google.com/js/api.js" type="text/javascript"></script>



        <script>
            var connConfig;  //global variable

            var dispBallData = function () {
                $('#ball-pos-x').text(ballPosObj.coord_x);
                $('#ball-pos-y').text(ballPosObj.coord_y);
                $('#ball-pos-lat').text(ballPosObj.coord_lat);
                $('#ball-pos-lon').text(ballPosObj.coord_lon);
                $('#ball-dist-play1').text(ballDistObj.dist_ball_play_1);
                $('#ball-dist-play2').text(ballDistObj.dist_ball_play_2);
                $('#ball-dist-total').text(ballDistObj.dist_players);
                console.log( ballDistObj.dist_players );
            };

            var dispAllPage2 = function (dispElem) {
                //hide all of the page 2 items
                if (dispElem) {
                    $('#page2').css('display', 'block');
                    $('.page2-only').css('display', 'block');
                    $("#top-panel-div").css('display', 'block');
                } else {
                    $('#page2').css('display', 'none');
                    $('.page2-only').css('display', 'none');
                    $("#top-panel-div").css('display', 'none');
                };
            };

            var dispPage3 = function (dispElem) {
                //hide / disp elements on page 3
                if (dispElem) {
                    $('.page2-only').css('display', 'none');
                } else {
                    $('.page2-only').css('display', 'block');
                };
            };


            $(document).ready(function () {
                $('[data-toggle="tooltip"]').tooltip();  //enable tool tips
                configData.dispRichOutput = true;
                //            dispPage3(false);
                //            dispAllPage2(false);
                getLocation();
                //display the ball coords
                dispBallData();

                //starts the db connection
                startConnection();

                var updateTimer = setInterval(db_ReadBallRec, 500);

                //add click listener to all movie pics
                //            $(document.body).on("click", ".movie-pic", evalPicClick);
                //            $(document.body).on("click", ".click-theater", evalTheaterClick);
                $(document.body).on("click", ".btn-info", function () {
                    $("#modInfo").css("display", "block");
                });
                $(document.body).on("click", ".close-Info", function () {
                    $("#modInfo").css("display", "none");
                });

                $("#bttnUserInput").on("click", function (event) {
                    //submit button was pushed
                    console.log("submit clicked");
                    event.preventDefault();
                    //already in 
                    if (configData.dispRichOutput === true) {
                        /*
                        theaterObj.searchLat = numeral($("#input-lat").val()).format("+0000.000000");
                        theaterObj.searchLon = numeral($("#input-lon").val()).format("+0000.000000");
                        */
                        var distInKM = parseFloat($("#input-dist").val()) * 1.60934;
                        theaterObj.searchLoc.dist = numeral(distInKM).format("+0000.0000");
                    };

                    if (theaterObj.searchLoc.lat === "+0000.000000" || theaterObj.searchLoc.long === "+0000.000000") {
                        //left blank, so put in Evanston as default
                        theaterObj.searchLoc.lat = numeral(42.048995).format("+0000.000000");
                        theaterObj.searchLoc.long = numeral(-87.684505).format("+0000.000000");
                    };

                    //for modal popups
                    modalMap.style.display = "none"; //initally off on page load
                    //document.getElementById("container-map").style.display = "block";

                    startSearches();
                    dispAllPage2(true);
                });
                /*
                var origin = new google.maps.LatLng(42.048361, -87.682224);
                var destination = new google.maps.LatLng(42.048995, -87.684505);
                var service = new google.maps.DistanceMatrixService();
                service.getDistanceMatrix(
                    {
                        origins: [origin],
                        destinations: [destination],
                        travelMode: 'DRIVING',
                        unitSystem: google.maps.UnitSystem.METRIC,
                        durationInTraffic: true,
                        avoidHighways: false,
                        avoidTolls: false
                    }, response_data);
    
                function response_data(responseDis, status) {
                    if (status !== google.maps.DistanceMatrixStatus.OK || status != "OK") {
                        console.log('Error:', status);
                        // OR
                        alert(status);
                    } else {
                        alert(responseDis.rows[0].elements[0].distance.text);
                    }
                };
                */
            });
        </script>

</body>

</html>